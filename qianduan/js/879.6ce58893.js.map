{"version":3,"file":"js/879.6ce58893.js","mappings":"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","sources":["webpack://bylw/./src/views/Statistics/Bill.vue","webpack://bylw/src/views/Statistics/Bill.vue","webpack://bylw/./src/views/Statistics/Bill.vue?41fb","webpack://bylw/./src/views/Statistics/Bill.vue?6c1b"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"Bill\"},[_c('el-button',{staticStyle:{\"margin\":\"0 15px 15px 0\"},attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleAdd}},[_vm._v(\"新增账单 \"),_c('i',{staticClass:\"el-icon-circle-plus-outline\",staticStyle:{\"font-size\":\"14px\"}})]),_c('el-tag',{attrs:{\"type\":\"warning\"}},[_vm._v(\"请确认账单后在仓库管理更新物品\")]),_c('el-dialog',{attrs:{\"title\":\"新增账单信息\",\"visible\":_vm.dialogFormVisible,\"width\":\"500px\"},on:{\"update:visible\":function($event){_vm.dialogFormVisible=$event},\"close\":_vm.closeDialog}},[_c('el-form',{attrs:{\"model\":_vm.form,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"采购人\"}},[_c('el-input',{model:{value:(_vm.form.nickname),callback:function ($$v) {_vm.$set(_vm.form, \"nickname\", $$v)},expression:\"form.nickname\"}})],1),_c('el-form-item',{attrs:{\"label\":\"电话\"}},[_c('el-input',{attrs:{\"autocomplete\":\"off\"},model:{value:(_vm.form.phone),callback:function ($$v) {_vm.$set(_vm.form, \"phone\", $$v)},expression:\"form.phone\"}})],1),_c('el-form-item',{attrs:{\"label\":\"名称\"}},[_c('el-input',{attrs:{\"autocomplete\":\"off\"},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"数量\"}},[_c('el-input',{attrs:{\"autocomplete\":\"off\"},model:{value:(_vm.form.count),callback:function ($$v) {_vm.$set(_vm.form, \"count\", $$v)},expression:\"form.count\"}})],1),_c('el-form-item',{attrs:{\"label\":\"单价\"}},[_c('el-input',{attrs:{\"autocomplete\":\"off\"},model:{value:(_vm.form.price),callback:function ($$v) {_vm.$set(_vm.form, \"price\", $$v)},expression:\"form.price\"}})],1),_c('el-form-item',{attrs:{\"label\":\"采购凭证\"}},[_c('el-upload',{ref:\"upload\",staticClass:\"picture-uploader\",attrs:{\"list-type\":\"picture\",\"action\":\"http://localhost:90/file/upload\",\"before-upload\":_vm.beforeUpload,\"on-exceed\":_vm.handleExceed,\"limit\":1,\"on-success\":_vm.handleSuccess}},[_c('el-button',{attrs:{\"slot\":\"trigger\",\"size\":\"small\",\"type\":\"primary\"},slot:\"trigger\"},[_c('i',{staticClass:\"el-icon-plus\"}),_vm._v(\"选择上传\")]),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\"只能上传jpg/png文件,且不超过1MB\")])],1)],1),_c('el-form-item',{attrs:{\"label\":\"备注\"}},[_c('el-input',{attrs:{\"autocomplete\":\"off\"},model:{value:(_vm.form.note),callback:function ($$v) {_vm.$set(_vm.form, \"note\", $$v)},expression:\"form.note\"}})],1)],1),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogFormVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"确 定\")])],1)],1),_c('el-table',{staticStyle:{\"width\":\"100%\",\"margin-bottom\":\"15px\"},attrs:{\"data\":_vm.tableData,\"stripe\":\"\",\"border\":\"\"}},[_c('el-table-column',{attrs:{\"prop\":\"id\",\"label\":\"id\",\"width\":\"60\"}}),_c('el-table-column',{attrs:{\"prop\":\"nickname\",\"label\":\"采购人\",\"width\":\"100\"}}),_c('el-table-column',{attrs:{\"prop\":\"phone\",\"label\":\"电话\",\"width\":\"120\"}}),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"名称\",\"width\":\"100\"}}),_c('el-table-column',{attrs:{\"prop\":\"count\",\"label\":\"数量\",\"width\":\"70\"}}),_c('el-table-column',{attrs:{\"prop\":\"price\",\"label\":\"单价\",\"width\":\"70\"}}),_c('el-table-column',{attrs:{\"prop\":\"picture\",\"label\":\"采购凭证\",\"width\":\"210\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-popover',{attrs:{\"placement\":\"right\",\"title\":\"\",\"trigger\":\"click\"}},[(scope.row.picture)?_c('el-image',{staticStyle:{\"max-height\":\"200px\",\"max-width\":\"200px\"},attrs:{\"slot\":\"reference\",\"src\":scope.row.picture,\"alt\":scope.row.picture},slot:\"reference\"}):_vm._e(),_c('el-image',{attrs:{\"src\":scope.row.picture}})],1)]}}])}),_c('el-table-column',{attrs:{\"prop\":\"time\",\"label\":\"确认时间\",\"width\":\"110\"}}),_c('el-table-column',{attrs:{\"prop\":\"note\",\"label\":\"备注\",\"width\":\"150\"}}),_c('el-table-column',{attrs:{\"prop\":\"state\",\"label\":\"处理状态\",\"width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.state =='未确认')?_c('span',{staticClass:\"text\",staticStyle:{\"backgroundColor\":\"#909399\"}},[_vm._v(_vm._s(scope.row.state))]):_c('span',{staticClass:\"text\",staticStyle:{\"backgroundColor\":\"#67C23A\"}},[_vm._v(_vm._s(scope.row.state))])]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"190\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return (_vm.user.username === 'admin')?[_c('el-popconfirm',{staticStyle:{\"margin-left\":\"5px\"},attrs:{\"confirm-button-text\":\"确认\",\"cancel-button-text\":\"我再想想\",\"icon\":\"el-icon-info\",\"icon-color\":\"red\",\"title\":\"是否确认账单？\"},on:{\"confirm\":function($event){return _vm.handleBill(scope.row.id)}}},[(scope.row.state=='未确认')?_c('el-button',{attrs:{\"slot\":\"reference\",\"size\":\"mini\",\"type\":\"info\"},slot:\"reference\"},[_vm._v(\"确认 \"),_c('i',{staticClass:\"el-icon-remove-outline\"})]):_vm._e()],1),_c('el-popconfirm',{staticStyle:{\"margin-left\":\"5px\"},attrs:{\"confirm-button-text\":\"确认\",\"cancel-button-text\":\"再想想\",\"icon\":\"el-icon-info\",\"icon-color\":\"red\",\"title\":\"您确定删除吗？\"},on:{\"confirm\":function($event){return _vm.handleDelete(scope.row.id)}}},[_c('el-button',{attrs:{\"slot\":\"reference\",\"size\":\"mini\",\"type\":\"danger\"},slot:\"reference\"},[_vm._v(\"删除 \"),_c('i',{staticClass:\"el-icon-remove-outline\"})])],1)]:undefined}}],null,true)})],1),_c('el-pagination',{attrs:{\"current-page\":_vm.pageNum,\"page-sizes\":[5, 10, 15, 20],\"page-size\":_vm.pageSize,\"layout\":\"total, sizes, prev, pager, next, jumper\",\"total\":_vm.total},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"Bill\">\r\n    <!-- 新增按钮 -->\r\n    <el-button type=\"primary\" @click=\"handleAdd\" style=\"margin:0 15px 15px 0;\">新增账单 <i class=\"el-icon-circle-plus-outline\" style=\"font-size: 14px;\"></i></el-button>\r\n    <el-tag type=\"warning\">请确认账单后在仓库管理更新物品</el-tag>\r\n    <!-- Form  dialog对话框 -->\r\n    <el-dialog title=\"新增账单信息\" :visible.sync=\"dialogFormVisible\" width=\"500px\" @close='closeDialog'>\r\n      <el-form :model=\"form\" label-width=\"80px\">\r\n        <el-form-item label=\"采购人\">\r\n          <el-input v-model=\"form.nickname\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"电话\">\r\n          <el-input v-model.lazy=\"form.phone\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"名称\">\r\n          <el-input v-model=\"form.name\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"数量\">\r\n          <el-input v-model=\"form.count\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"单价\">\r\n          <el-input v-model=\"form.price\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"采购凭证\">\r\n          <!-- 自动提交auto-upload属性为false时，on-success和before-upload属性会失效，我们将他们的操作移到on-change中来 -->\r\n          <!--:http-request覆盖默认的上传行为，可以自定义上传的实现-->\r\n          <el-upload\r\n            class=\"picture-uploader\" ref=\"upload\"\r\n            list-type=\"picture\"\r\n            action=\"http://localhost:90/file/upload\"\r\n            :before-upload=\"beforeUpload\"\r\n            :on-exceed=\"handleExceed\"\r\n            :limit=\"1\"\r\n            :on-success=\"handleSuccess\"\r\n          >\r\n            <el-button slot=\"trigger\" size=\"small\" type=\"primary\"><i class=\"el-icon-plus\"></i>选择上传</el-button>\r\n            <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件,且不超过1MB</div>\r\n          </el-upload>\r\n        </el-form-item>\r\n        <el-form-item label=\"备注\">\r\n          <el-input v-model=\"form.note\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"save\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!-- data -->\r\n    <el-table :data=\"tableData\" stripe border style=\"width: 100%; margin-bottom: 15px;\">\r\n      <el-table-column prop=\"id\" label=\"id\" width=\"60\"></el-table-column>\r\n      <el-table-column prop=\"nickname\" label=\"采购人\" width=\"100\"></el-table-column>\r\n      <el-table-column prop=\"phone\" label=\"电话\" width=\"120\"></el-table-column>\r\n      <el-table-column prop=\"name\" label=\"名称\" width=\"100\"></el-table-column>\r\n      <el-table-column prop=\"count\" label=\"数量\" width=\"70\"></el-table-column>\r\n      <el-table-column prop=\"price\" label=\"单价\" width=\"70\"></el-table-column>\r\n      <el-table-column prop=\"picture\" label=\"采购凭证\" width=\"210\">\r\n        <template slot-scope=\"scope\">\r\n          <el-popover placement=\"right\" title=\"\" trigger=\"click\">\r\n            <el-image slot=\"reference\" v-if=\"scope.row.picture\" :src=\"scope.row.picture\" :alt=\"scope.row.picture\" style=\"max-height: 200px;max-width: 200px\"></el-image>\r\n            <el-image :src=\"scope.row.picture\"></el-image>\r\n         </el-popover>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"time\" label=\"确认时间\" width=\"110\"></el-table-column>\r\n      <el-table-column prop=\"note\" label=\"备注\" width=\"150\"></el-table-column>\r\n      <el-table-column prop=\"state\" label=\"处理状态\" width=\"100\">\r\n        <template slot-scope=\"scope\">\r\n          <span v-if=\"scope.row.state =='未确认'\" style=\"backgroundColor: #909399;\" class=\"text\">{{scope.row.state}}</span> \r\n          <span v-else style=\"backgroundColor: #67C23A;\" class=\"text\">{{scope.row.state}}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" width=\"190\">\r\n        <template slot-scope=\"scope\" v-if=\"user.username === 'admin'\"> \r\n          <el-popconfirm\r\n            style=\"margin-left: 5px;\"\r\n            confirm-button-text='确认'\r\n            cancel-button-text='我再想想'\r\n            icon=\"el-icon-info\"\r\n            icon-color=\"red\"\r\n            title=\"是否确认账单？\"\r\n            @confirm=\"handleBill(scope.row.id)\"\r\n          >\r\n            <el-button slot=\"reference\" size=\"mini\" type=\"info\" v-if=\"scope.row.state=='未确认'\">确认 <i class=\"el-icon-remove-outline\"></i></el-button>\r\n          </el-popconfirm>\r\n          <el-popconfirm\r\n            style=\"margin-left: 5px;\"\r\n            confirm-button-text='确认'\r\n            cancel-button-text='再想想'\r\n            icon=\"el-icon-info\"\r\n            icon-color=\"red\"\r\n            title=\"您确定删除吗？\"\r\n            @confirm=\"handleDelete(scope.row.id)\"\r\n          >\r\n            <el-button slot=\"reference\" size=\"mini\" type=\"danger\">删除 <i class=\"el-icon-remove-outline\"></i></el-button>\r\n          </el-popconfirm>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <el-pagination\r\n      @size-change=\"handleSizeChange\"\r\n      @current-change=\"handleCurrentChange\"\r\n      :current-page=\"pageNum\"\r\n      :page-sizes=\"[5, 10, 15, 20]\"\r\n      :page-size=\"pageSize\"\r\n      layout=\"total, sizes, prev, pager, next, jumper\"\r\n      :total=\"total\">\r\n    </el-pagination>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    name:'Bill',\r\n    data() {\r\n      return {\r\n        tableData:[],\r\n        pageNum:1,  //当前页数\r\n        pageSize:5,   //页数的大小\r\n        total:0,\r\n        user:JSON.parse(sessionStorage.getItem(\"user\")) || '',\r\n        staff:'',\r\n        form:{ name:'',nickname:'',phone:'',count:'',price:'',total:'',picture:'',note:'' },\r\n        dialogFormVisible: false, //新增按钮的表单对话框的显示\r\n        fileList: []//存放上传文件\r\n      }\r\n    },\r\n    created(){\r\n      this.load()\r\n    },\r\n    methods: {\r\n      handleSizeChange(val) {\r\n        this.pageSize = val\r\n        this.loadTwo()\r\n      },\r\n      handleCurrentChange(val) {\r\n        this.pageNum = val\r\n        this.loadTwo()\r\n      },\r\n      async load(){\r\n        //员工通过手机号获取自己提交的账单，管理员获取所有\r\n        if(this.user.level !== 'admin'){\r\n          const res = await this.getStaffPhone()\r\n          this.staff = res.data\r\n        }\r\n        this.loadTwo()\r\n      },\r\n      loadTwo(){\r\n        // if是员工，只获取自己的，管理员获取全部\r\n        this.request.get('/api/bill/page',{params:{pageNum:this.pageNum,pageSize:this.pageSize, phone: this.user.level === 'admin' ? '' : this.staff.phone}})\r\n        .then((value) => {\r\n          if(value.code === '200'){\r\n            this.tableData=value.data.records \r\n            this.total=value.data.total\r\n          }\r\n        })\r\n      },\r\n      getStaffPhone(){\r\n        //员工根据自己的id对应员工表的pid以获取对应员工表的id\r\n        return this.request.get('/api/staff/pid/'+ this.user.id)\r\n      },\r\n      //除管理员，其他的新增账单需经过管理员确定\r\n      handleBill(id) {\r\n        this.request.post('/api/bill',{id:id,state:'已确认',time: this.tool.getNowDate()}).then(res=>{\r\n          if(res.code === '200'){\r\n            this.load()\r\n          }\r\n        })  \r\n      },\r\n      //只有管理员能删除\r\n      handleDelete(id) {\r\n        this.request.delete('/api/bill/'+id).then(res=>{\r\n          if(res.code === '200'){\r\n            this.$message.success(\"删除成功\")\r\n            this.load()\r\n          }else{\r\n            this.$message.error(\"删除失败\")\r\n          }\r\n        })  \r\n      },\r\n      //新增按钮\r\n      handleAdd(){\r\n        this.form={}\r\n        this.form.nickname=this.user.nickname //投诉人的名字是姓名\r\n        this.form.phone=this.staff.phone || ''\r\n        this.dialogFormVisible = true\r\n      },\r\n      //新增对话框确定\r\n      save(){\r\n        this.form.total = this.form.count*this.form.price\r\n        console.log(this.form.total);\r\n        this.request.post('/api/bill',this.form).then(res => {\r\n          if(res.code === '200'){\r\n            this.$message.success(\"新增/编辑成功\")\r\n            this.dialogFormVisible = false\r\n            this.load()\r\n          }else{\r\n            this.$message.error(\"新增/编辑失败\")\r\n          }\r\n        })   \r\n      },\r\n      //上传前验证图片类型和大小\r\n      beforeUpload(file) {\r\n        let types = ['image/jpeg', 'image/jpg', 'image/gif', 'image/bmp', 'image/png'];\r\n        const isImage = types.includes(file.type);\r\n        const isEXceedSize = file.size / 1024 / 1024 < 1;\r\n        if (!isImage) {\r\n          this.$message.error('上传图片只能是 JPG、JPEG、gif、bmp、PNG 格式!');\r\n          return false;\r\n        }\r\n        if (!isEXceedSize) {\r\n          this.$message.error('上传图片大小不能超过 1MB!');\r\n          return false;\r\n        }\r\n        return true;\r\n      },\r\n      // 文件数量过多时提醒\r\n      handleExceed() {\r\n        this.$message.error('最多支持1个附件上传' )\r\n      },\r\n      handleSuccess(res){\r\n        this.$message.success(\"上传成功\")\r\n        this.form.picture = res\r\n      },\r\n      //关闭对话框，清空文件上传列表\r\n      closeDialog(){\r\n        this.$refs.upload.clearFiles();\r\n      }\r\n      \r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.Bill{\r\n  .search{\r\n    .el-input{\r\n      margin-right: 5px;\r\n    }\r\n  }\r\n  .el-table .warning-row {\r\n    background: oldlace;\r\n  }\r\n\r\n  .el-table .success-row {\r\n    background: #f0f9eb;\r\n  }\r\n  .el-tooltip__popper{\r\n    display: none;\r\n  }\r\n  .el-popover{\r\n    border: 1px solid #333;\r\n    min-height: 150px;\r\n  }\r\n  .picture-uploader{\r\n    text-align: center;\r\n    padding-bottom: 15px;\r\n  }\r\n  .picture-uploader .el-upload {\r\n    border: 1px dashed #d9d9d9;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    position: relative;\r\n    overflow: hidden;\r\n  }\r\n  .picture-uploader .el-upload:hover {\r\n    border-color: #409EFF;\r\n  }\r\n  .text{\r\n    color:#000;\r\n    padding:5px;\r\n    border-radius:20px;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Bill.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Bill.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Bill.vue?vue&type=template&id=db765bea&scoped=true&\"\nimport script from \"./Bill.vue?vue&type=script&lang=js&\"\nexport * from \"./Bill.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Bill.vue?vue&type=style&index=0&id=db765bea&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"db765bea\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","staticStyle","attrs","on","handleAdd","_v","dialogFormVisible","$event","closeDialog","form","model","value","nickname","callback","$$v","$set","expression","phone","name","count","price","ref","beforeUpload","handleExceed","handleSuccess","slot","note","save","tableData","scopedSlots","_u","key","fn","scope","row","picture","_e","state","_s","user","username","handleBill","id","handleDelete","undefined","pageNum","pageSize","total","handleSizeChange","handleCurrentChange","staticRenderFns","data","staff","fileList","created","methods","loadTwo","params","then","getStaffPhone","time","console","component"],"sourceRoot":""}