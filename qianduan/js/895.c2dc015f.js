"use strict";(self["webpackChunkbylw"]=self["webpackChunkbylw"]||[]).push([[895],{1895:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var l=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"search"},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入文件名称","prefix-icon":"el-icon-search"},model:{value:e.name,callback:function(t){e.name="string"===typeof t?t.trim():t},expression:"name"}}),t("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:e.load}},[e._v("搜索")]),t("el-button",{attrs:{type:"warning"},on:{click:function(t){e.name="",e.load()}}},[e._v("重置")])],1),t("el-upload",{ref:"upload",staticStyle:{display:"inline-block"},attrs:{action:"http://localhost:90/file/upload","show-file-list":!1,"on-success":e.onSuccess,"before-upload":e.beforeUpload}},[t("el-button",{staticStyle:{margin:"10px 10px 10px 0"},attrs:{type:"primary"}},[e._v("文件上传 "),t("i",{staticClass:"el-icon-top"})])],1),t("el-dialog",{attrs:{title:"文件信息更改",visible:e.dialogFormVisible,width:"550px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{attrs:{model:e.form,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"图片名"}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1),t("el-table",{staticStyle:{width:"100%","margin-bottom":"15px"},attrs:{data:e.tableData,stripe:"",border:""}},[t("el-table-column",{attrs:{prop:"id",label:"id",width:"100"}}),t("el-table-column",{attrs:{prop:"name",label:"文件名称",width:"350"}}),t("el-table-column",{attrs:{prop:"url",label:"图片预览",width:"210"},scopedSlots:e._u([{key:"default",fn:function(a){return[e.PicReg.test(a.row.type)?t("el-popover",{attrs:{placement:"right",title:"",trigger:"click"}},[a.row.url?t("el-image",{staticStyle:{"max-height":"120px","max-width":"120px"},attrs:{slot:"reference",src:a.row.url,alt:a.row.url},slot:"reference"}):e._e(),t("el-image",{attrs:{src:a.row.url}})],1):t("el-tag",[e._v("非图片格式")])]}}])}),t("el-table-column",{attrs:{prop:"type",label:"文件类型",width:"100"}}),t("el-table-column",{attrs:{prop:"size",label:"文件大小(kb)",width:"120"}}),t("el-table-column",{attrs:{label:"下载"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleLoadFile(a.row)}}},[e._v("下载")])]}}])}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.edit(a.row)}}},[e._v("编辑")])]}}])})],1),t("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[7,14,21,28],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},i=[],o={name:"Files",data(){return{tableData:[],pageNum:1,pageSize:7,total:0,name:"",PicReg:/^(jpg|bmp|gif|ico|pcx|jpeg|tif|png|raw|tga)$/,dialogFormVisible:!1,form:{id:"",name:""}}},created(){this.load()},methods:{handleSizeChange(e){this.pageSize=e,this.load()},handleCurrentChange(e){this.pageNum=e,this.load()},load(){this.request.get("/api/file/page",{params:{pageNum:this.pageNum,pageSize:this.pageSize,name:this.name}}).then((e=>{"200"==e.code&&(this.tableData=e.data.records,this.total=e.data.total)}))},handleLoadFile(e){console.log(e),window.open(e.url)},onSuccess(){this.$message.success("文件上传成功"),this.load()},beforeUpload(e){const t=e.size/1024/1024<1;return!!t||(this.$message.error("上传文件大小不能超过 1MB!"),!1)},edit(e){this.form.id=e.id,this.form.name=e.name,this.dialogFormVisible=!0},save(){this.request.post("/api/file/update",this.form).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load(),this.dialogFormVisible=!1):this.$message.error("error")}))}}},r=o,s=a(1001),n=(0,s.Z)(r,l,i,!1,null,"2a724aae",null),c=n.exports}}]);
//# sourceMappingURL=895.c2dc015f.js.map