"use strict";(self["webpackChunkbylw"]=self["webpackChunkbylw"]||[]).push([[759],{2759:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"Warehouse"},[t("div",{staticClass:"search"},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"物品名称","prefix-icon":"el-icon-search",clearable:""},model:{value:e.name,callback:function(t){e.name="string"===typeof t?t.trim():t},expression:"name"}}),t("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:e.load}},[e._v("搜索")]),t("el-button",{attrs:{type:"warning"},on:{click:function(t){e.name=""}}},[e._v("重置")])],1),t("div",{staticStyle:{"margin-bottom":"15px"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增物品 "),t("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"font-size":"14px"}})]),t("el-tag",{staticStyle:{margin:"15px 50px 0 15px"}},[e._v("请确认物品变更无误")]),t("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.openHistoryInfo}},[e._v("GO!")]),t("el-tag",{staticStyle:{margin:"15px 0 0 15px"}},[e._v("前往仓库物品历史变更信息...")]),t("el-drawer",{attrs:{title:"仓库历史信息",visible:e.drawer,size:"50%"},on:{"update:visible":function(t){e.drawer=t}}},[t("div",[t("el-table",{staticStyle:{width:"100%","margin-bottom":"15px"},attrs:{data:e.tableData2,stripe:"",border:""}},[t("el-table-column",{attrs:{prop:"id",label:"id",width:"55"}}),t("el-table-column",{attrs:{prop:"name",label:"汇报人",width:"90"}}),t("el-table-column",{attrs:{prop:"time",label:"汇报时间",width:"140"}}),t("el-table-column",{attrs:{prop:"place",label:"地点",width:"90"}}),t("el-table-column",{attrs:{prop:"facility",label:"设备",width:"120"}}),t("el-table-column",{attrs:{prop:"situation",label:"情况",width:"140"}}),t("el-table-column",{attrs:{label:"操作",width:"132"},scopedSlots:e._u([{key:"default",fn:function(a){return"admin"===e.user.level?[t("el-popconfirm",{staticStyle:{"margin-left":"5px"},attrs:{"confirm-button-text":"确认","cancel-button-text":"再想想",icon:"el-icon-info","icon-color":"red",title:"您确定删除吗？"},on:{confirm:function(t){return e.handleDeleteH(a.row.id)}}},[t("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v("删除 "),t("i",{staticClass:"el-icon-remove-outline"})])],1)]:void 0}}],null,!0)})],1),t("el-pagination",{attrs:{"current-page":e.pageNum2,"page-sizes":[5,10,15,20],"page-size":e.pageSize2,layout:"total, sizes, prev, pager, next, jumper",total:e.total2},on:{"size-change":e.handleSizeChange2,"current-change":e.handleCurrentChange2}})],1)])],1),t("el-dialog",{attrs:{title:"物品信息",visible:e.dialogFormVisible,width:"500px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{attrs:{model:e.form,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"名称"}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"数量"}},[t("el-input",{model:{value:e.form.count,callback:function(t){e.$set(e.form,"count",t)},expression:"form.count"}})],1),t("el-form-item",{attrs:{label:"描述"}},[t("el-input",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e.edit?t("el-form-item",{attrs:{label:"使用情况"}},[t("el-select",{staticStyle:{"margin-bottom":"10px"},attrs:{placeholder:"请选择物品状态"},model:{value:e.WareUse.state,callback:function(t){e.$set(e.WareUse,"state",t)},expression:"WareUse.state"}},[t("el-option",{attrs:{value:"使用"}}),t("el-option",{attrs:{value:"增添"}})],1),t("el-input",{attrs:{placeholder:"请输入物品数量"},model:{value:e.WareUse.count,callback:function(t){e.$set(e.WareUse,"count",t)},expression:"WareUse.count"}})],1):e._e()],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1),t("el-table",{staticStyle:{width:"100%","margin-bottom":"15px"},attrs:{data:e.tableData1,stripe:"",border:""}},[t("el-table-column",{attrs:{prop:"id",label:"编号",width:"87"}}),t("el-table-column",{attrs:{prop:"name",label:"名称",width:"150"}}),t("el-table-column",{attrs:{prop:"count",label:"数量",width:"130"}}),t("el-table-column",{attrs:{prop:"description",label:"描述",width:"220"}}),t("el-table-column",{attrs:{label:"操作",width:"230"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleEdit(a.row,{edit:!0})}}},[e._v("编辑 "),t("i",{staticClass:"el-icon-edit"})]),t("el-popconfirm",{staticStyle:{"margin-left":"5px"},attrs:{"confirm-button-text":"确认","cancel-button-text":"再想想",icon:"el-icon-info","icon-color":"red",title:"您确定删除吗？"},on:{confirm:function(t){return e.handleDelete(a.row.id)}}},["admin"===e.user.level?t("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v("删除 "),t("i",{staticClass:"el-icon-remove-outline"})]):e._e()],1)]}}])})],1),t("el-pagination",{attrs:{"current-page":e.pageNum1,"page-sizes":[5,10,15,20],"page-size":e.pageSize1,layout:"total, sizes, prev, pager, next, jumper",total:e.total1},on:{"size-change":e.handleSizeChange1,"current-change":e.handleCurrentChange1}})],1)},l=[],s={name:"Warehouse",data(){return{tableData1:[],pageNum1:1,pageSize1:5,total1:0,tableData2:[],pageNum2:1,pageSize2:5,total2:0,name:"",user:JSON.parse(sessionStorage.getItem("user"))||"",form:{name:"",count:"",description:""},dialogFormVisible:!1,WareUse:{count:"",state:""},edit:!1,drawer:!1}},created(){this.load()},methods:{handleSizeChange1(e){this.pageSize1=e,this.load()},handleCurrentChange1(e){this.pageNum1=e,this.load()},handleSizeChange2(e){this.pageSize2=e,this.load()},handleCurrentChange2(e){this.pageNum2=e,this.load()},load(){this.request.get("/api/warehouse/page",{params:{pageNum:this.pageNum1,pageSize:this.pageSize1,name:this.name}}).then((e=>{"200"===e.code&&(this.tableData1=e.data.records,this.total1=e.data.total)}))},handleDelete(e){this.request.delete("/api/warehouse/"+e).then((e=>{"200"===e.code?(this.$message.success("删除成功"),this.load()):this.$message.error("删除失败")}))},handleDeleteH(e){this.request.delete("/api/situation/"+e).then((e=>{"200"===e.code?(this.$message.success("删除成功"),this.getHistoryInfo()):this.$message.error("删除失败")}))},handleAdd(){this.form={},this.dialogFormVisible=!0},handleEdit(e,t){this.form=e,this.WareUse={},t.edit&&(this.edit=!0),this.dialogFormVisible=!0},save(){"使用"==this.WareUse.state?this.form.count-=this.WareUse.count:"增添"==this.WareUse.state&&(this.form.count+=this.WareUse.count-0),this.request.post("/api/situation",{name:this.user.nickname,place:"仓库",facility:this.form.name,type:"warehouse",situation:this.edit?this.WareUse.state+"了"+this.WareUse.count+"件物品":"新增新物品："+this.form.name+" "+this.form.count+"件"}).then((e=>{"200"===e.code&&console.log(e)})),this.request.post("/api/warehouse",this.form).then((e=>{"200"===e.code?(this.$message.success("新增/编辑成功"),this.dialogFormVisible=!1,this.edit=!1,this.load()):this.$message.error("新增/编辑失败")}))},openHistoryInfo(){this.drawer=!0,this.getHistoryInfo()},getHistoryInfo(){this.request.get("/api/situation/page",{params:{pageNum:this.pageNum2,pageSize:this.pageSize2,type:"warehouse"}}).then((e=>{"200"===e.code&&(this.tableData2=e.data.records,this.total2=e.data.total)}))}}},o=s,r=a(1001),n=(0,r.Z)(o,i,l,!1,null,"2e819e9b",null),c=n.exports}}]);
//# sourceMappingURL=759.1000337b.js.map