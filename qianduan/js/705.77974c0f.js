"use strict";(self["webpackChunkbylw"]=self["webpackChunkbylw"]||[]).push([[705],{4489:function(e,t,o){o.r(t),o.d(t,{default:function(){return p}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"contain"},[t("div",{staticClass:"login"},[t("h1",{staticStyle:{margin:"15px 0 30px 0"}},[e._v("社区物业管理系统")]),t("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.ruleForm,"label-position":e.labelPosition}},[t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{attrs:{size:"medium",placeholder:"  用户名","prefix-icon":"el-icon-user",clearable:"",autocomplete:"off"},model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{size:"medium",type:"password",placeholder:"  密码","show-password":!0,"prefix-icon":"el-icon-lock",clearable:"",autocomplete:"off"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),t("el-form-item",[t("el-select",{attrs:{placeholder:"请选择级别"},model:{value:e.ruleForm.level,callback:function(t){e.$set(e.ruleForm,"level",t)},expression:"ruleForm.level"}},[t("el-option",{attrs:{label:"用户",value:"user"}}),t("el-option",{attrs:{label:"员工",value:"staff"}}),t("el-option",{attrs:{label:"管理员",value:"admin"}})],1)],1),t("el-form-item",{attrs:{prop:"code"}},[t("el-col",{attrs:{span:12}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入验证码",clearable:""},model:{value:e.ruleForm.code,callback:function(t){e.$set(e.ruleForm,"code",t)},expression:"ruleForm.code"}})],1),t("el-col",{attrs:{span:12}},[t("div",{staticClass:"loginCode",on:{click:e.refreshCode}},[t("identify",{attrs:{identifyCode:e.identifyCode}})],1)])],1),t("el-button",{staticStyle:{width:"100%",margin:"0 20px 20px 0"},attrs:{type:"primary"},on:{click:e.log}},[e._v("登录")]),t("el-link",{staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.register}},[e._v("注册...")])],1)],1)])},i=[],s=(o(541),o(7658),function(){var e=this,t=e._self._c;return t("div",{staticClass:"s-canvas"},[t("canvas",{attrs:{id:"s-canvas",width:e.contentWidth,height:e.contentHeight}})])}),a=[],l={name:"identify",props:{identifyCode:{type:String,default:"6666"},fontSizeMin:{type:Number,default:30},fontSizeMax:{type:Number,default:32},backgroundColorMin:{type:Number,default:255},backgroundColorMax:{type:Number,default:255},colorMin:{type:Number,default:30},colorMax:{type:Number,default:70},lineColorMin:{type:Number,default:250},lineColorMax:{type:Number,default:255},contentWidth:{type:Number,default:112},contentHeight:{type:Number,default:38}},methods:{randomNum(e,t){return Math.floor(Math.random()*(t-e)+e)},randomColor(e,t){let o=this.randomNum(e,t),r=this.randomNum(e,t),i=this.randomNum(e,t);return"rgb("+o+","+r+","+i+")"},drawPic(){let e=document.getElementById("s-canvas"),t=e.getContext("2d");t.textBaseline="bottom",t.fillStyle=this.randomColor(this.backgroundColorMin,this.backgroundColorMax),t.fillRect(0,0,this.contentWidth,this.contentHeight);for(let o=0;o<this.identifyCode.length;o++)this.drawText(t,this.identifyCode[o],o);this.drawLine(t),this.drawDot(t)},drawText(e,t,o){e.fillStyle=this.randomColor(this.colorMin,this.colorMax),e.font=this.randomNum(this.fontSizeMin,this.fontSizeMax)+"px SimHei";let r=(o+1)*(this.contentWidth/(this.identifyCode.length+1)),i=this.randomNum(this.fontSizeMax,this.contentHeight-5);var s=this.randomNum(-45,45);e.translate(r,i),e.rotate(s*Math.PI/180),e.fillText(t,0,0),e.rotate(-s*Math.PI/180),e.translate(-r,-i)},drawLine(e){for(let t=0;t<4;t++)e.strokeStyle=this.randomColor(this.lineColorMin,this.lineColorMax),e.beginPath(),e.moveTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),e.lineTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),e.stroke()},drawDot(e){for(let t=0;t<30;t++)e.fillStyle=this.randomColor(100,255),e.beginPath(),e.arc(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight),1,0,2*Math.PI),e.fill()}},watch:{identifyCode(){this.drawPic()}},mounted(){this.drawPic()}},n=l,d=o(1001),m=(0,d.Z)(n,s,a,!1,null,"92b88252",null),u=m.exports,h={name:"Login",components:{identify:u},data(){return{labelPosition:"left",identifyCodes:"1234567890abcdefjhijklmnopqrstuvwxyz",identifyCode:"",ruleForm:{username:"",password:"",level:"user",code:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{pattern:/^[0-9a-zA-Z_]{3,15}$/,message:"用户名由3到15位数字、字母或下划线组成",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^[0-9a-zA-Z_]{3,20}$/,message:"密码由3到20位数字、字母或下划线组成",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"},{min:4,max:4,message:"验证码为4位字符,不包含空格",trigger:"blur"}]}}},mounted(){document.addEventListener("keyup",(e=>{let t=window.event.keyCode;13==t&&this.log()})),this.refreshCode()},methods:{refreshCode(){this.identifyCode="",this.makeCode(4)},makeCode(e){for(let t=0;t<e;t++)this.identifyCode+=this.identifyCodes[this.randomNum(0,this.identifyCodes.length)]},randomNum(e,t){return Math.floor(Math.random()*(t-e)+e)},log(){this.$refs.ruleForm.validate((e=>this.ruleForm.code!==this.identifyCode?(this.$message.error("验证码错误"),void this.refreshCode()):e?void this.request.post("api/user/login",this.ruleForm).then((e=>{"200"===e.code?(e.data.password="",sessionStorage.setItem("user",JSON.stringify(e.data)),this.$store.commit("man/tabListAdd",{path:"home",name:"首页"}),this.request.get("/api/menu/"+this.ruleForm.level).then((e=>{if("200"===e.code){const t=e.data;t.unshift({path:"home",name:"首页",icon:"s-home"}),sessionStorage.setItem("menu",JSON.stringify(e.data)),this.$store.commit("man/addMenu",this.$router)}})),sessionStorage.setItem("refresh",!0),console.log("home"),this.$router.push("/home"),this.$message.success("login success")):this.$message.error(e.msg)})):(console.log("error submit!!"),!1)))},register(){this.$router.push("/register")}}},c=h,f=(0,d.Z)(c,r,i,!1,null,"7fc0ece0",null),p=f.exports}}]);
//# sourceMappingURL=705.77974c0f.js.map